{"remainingRequest":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\desktop\\rent\\view\\src\\views\\admin\\Main.vue?vue&type=style&index=0&id=6b581c9a&scoped=true&lang=scss&","dependencies":[{"path":"D:\\desktop\\rent\\view\\src\\views\\admin\\Main.vue","mtime":1771039440729},{"path":"D:\\desktop\\rent\\view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1765027960330},{"path":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1765027965207},{"path":"D:\\desktop\\rent\\view\\node_modules\\postcss-loader\\src\\index.js","mtime":1765027962540},{"path":"D:\\desktop\\rent\\view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1765027958888},{"path":"D:\\desktop\\rent\\view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1765027958923},{"path":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\index.js","mtime":1765027963512}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5tYWluLWNvbnRhaW5lciB7DQogIGRpc3BsYXk6IGZsZXg7DQogIHdpZHRoOiAxMDAlOw0KDQogIC5sZWZ0IHsNCiAgICB3aWR0aDogNjUlOw0KICAgIHBhZGRpbmctaW5saW5lOiAzMHB4Ow0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQoNCiAgICAuc3RhdGljLXZhbHVlIHsNCiAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyNDgsIDI0OCwgMjQ4KTsNCiAgICAgIHBhZGRpbmc6IDIwcHg7DQogICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgICAgYm9yZGVyLXJhZGl1czogNXB4Ow0KICAgIH0NCiAgfQ0KDQogIC5yaWdodCB7DQogICAgd2lkdGg6IDM1JTsNCiAgICBwYWRkaW5nOiAyMHB4Ow0KICAgIGJhY2tncm91bmQ6ICNmZmY7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDEycHggMCByZ2JhKDAsIDAsIDAsIDAuMSk7DQogIH0NCn0NCg0KLmNpdHktbGlzdCB7DQogIC5jaXR5LWl0ZW0gew0KICAgIG1hcmdpbi1ib3R0b206IDE1cHg7DQoNCiAgICAmOmxhc3QtY2hpbGQgew0KICAgICAgbWFyZ2luLWJvdHRvbTogMDsNCiAgICB9DQoNCiAgICAuY2l0eS1pbmZvIHsNCiAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgICBtYXJnaW4tYm90dG9tOiA1cHg7DQogICAgICBmb250LXNpemU6IDE0cHg7DQoNCiAgICAgIC5jaXR5LW5hbWUgew0KICAgICAgICBjb2xvcjogIzYwNjI2NjsNCiAgICAgIH0NCg0KICAgICAgLmNpdHktY291bnQgew0KICAgICAgICBjb2xvcjogIzQwOWVmZjsNCiAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICB9DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["Main.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkKA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Main.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\r\n  <div class=\"main-container\">\r\n    <div class=\"left\">\r\n      <div class=\"static-value\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"6\" v-for=\"(item, index) in staticValues\" :key=\"index\">\r\n            <div>\r\n              <el-statistic\r\n                group-separator=\",\"\r\n                :precision=\"0\"\r\n                :value=\"item.count\"\r\n                :title=\"item.name\"\r\n              ></el-statistic>\r\n            </div>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n\r\n      <div style=\"margin-top: 30px;\">\r\n        <LineChart\r\n          :tooltipFormatter=\"customTooltipFormatter\"\r\n          height=\"450px\"\r\n          tag=\"房源存量趋势\"\r\n          :values=\"values\"\r\n          :date=\"dateList\"\r\n          @on-selected=\"onSelected\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"right\">\r\n      <h2 style=\"margin-top: 0;\">城市待租房源分布</h2>\r\n\r\n      <div class=\"city-list\">\r\n        <div\r\n          v-for=\"(city, index) in cityHouseList\"\r\n          :key=\"index\"\r\n          class=\"city-item\"\r\n        >\r\n          <div class=\"city-info\">\r\n            <span class=\"city-name\">{{ city.name }}</span>\r\n\r\n            <span class=\"city-count\">{{ city.count }}套</span>\r\n          </div>\r\n\r\n          <el-progress\r\n            :percentage=\"calculatePercentage(city.count)\"\r\n            :show-text=\"false\"\r\n            :stroke-width=\"12\"\r\n            :color=\"getProgressColor(index)\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport LineChart from \"@/components/LineChart\";\r\nexport default {\r\n  components: { LineChart },\r\n  data() {\r\n    return {\r\n      staticValues: [],\r\n      values: [], // y轴\r\n      dateList: [], // x轴\r\n      cityHouseList: [], // 城市待租房源分布\r\n      defaultSelectDays: 365, //默认查一年\r\n      defaultSelectCity: 10, // 默认查询城市数\r\n      selectedSort: \"count-desc\", // 添加排序方式\r\n      colorPalette: [\r\n        // 添加颜色配置\r\n        \"#409EFF\",\r\n        \"#67C23A\",\r\n        \"#E6A23C\",\r\n        \"#F56C6C\",\r\n        \"#909399\",\r\n        \"#8E44AD\",\r\n        \"#1ABC9C\",\r\n        \"#D35400\",\r\n        \"#3498DB\",\r\n        \"#E74C3C\"\r\n      ]\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchStaticValues();\r\n    this.fetchHouseLineChart(this.defaultSelectDays);\r\n    this.fetchCityHouseRange(this.defaultSelectCity);\r\n  },\r\n  computed: {\r\n    sortedCityHouseList() {\r\n      const list = [...this.cityHouseList];\r\n      switch (this.selectedSort) {\r\n        case \"count-desc\":\r\n          return list.sort((a, b) => b.count - a.count);\r\n        case \"count-asc\":\r\n          return list.sort((a, b) => a.count - b.count);\r\n        case \"name-asc\":\r\n          return list.sort((a, b) => a.name.localeCompare(b.name));\r\n        case \"name-desc\":\r\n          return list.sort((a, b) => b.name.localeCompare(a.name));\r\n        default:\r\n          return list;\r\n      }\r\n    },\r\n    maxCount() {\r\n      if (this.cityHouseList.length === 0) return 1;\r\n      return Math.max(...this.cityHouseList.map(city => city.count));\r\n    }\r\n  },\r\n  methods: {\r\n    getProgressColor(index) {\r\n      return this.colorPalette[index % this.colorPalette.length];\r\n    },\r\n    calculatePercentage(count) {\r\n      return (count / this.maxCount) * 100;\r\n    },\r\n    // 自定义提示框格式\r\n    customTooltipFormatter(params) {\r\n      // params是一个数组，包含当前点的所有信息\r\n      const date = params[0].axisValue; // 获取日期\r\n      const value = params[0].data; // 获取数值\r\n      return `${date}号，共上线${value}套房源`;\r\n    },\r\n    onSelected(day) {\r\n      this.fetchHouseLineChart(day);\r\n    },\r\n    async fetchCityHouseRange(limit) {\r\n      try {\r\n        const { data } = await this.$axios.get(\r\n          `/dashboard/cityHouseRange/${limit}`\r\n        );\r\n        this.cityHouseList = data;\r\n      } catch (error) {\r\n        console.error(\"城市待租房源分布:\", error);\r\n      }\r\n    },\r\n    async fetchHouseLineChart(day) {\r\n      try {\r\n        const { data } = await this.$axios.get(\r\n          `/dashboard/houseLineChart/${day}`\r\n        );\r\n        this.dateList = data.map(entity => entity.name); // 处理成x轴数据格式\r\n        this.values = data.map(entity => entity.count); // 处理成y轴数据格式\r\n      } catch (error) {\r\n        console.error(\"房源存量趋势统计异常:\", error);\r\n      }\r\n    },\r\n    async fetchStaticValues() {\r\n      try {\r\n        const { data } = await this.$axios.get(\"/dashboard/mainStatic\");\r\n        this.staticValues = data;\r\n      } catch (error) {\r\n        console.error(\"静态数据统计异常:\", error);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.main-container {\r\n  display: flex;\r\n  width: 100%;\r\n\r\n  .left {\r\n    width: 65%;\r\n    padding-inline: 30px;\r\n    box-sizing: border-box;\r\n\r\n    .static-value {\r\n      background-color: rgb(248, 248, 248);\r\n      padding: 20px;\r\n      box-sizing: border-box;\r\n      border-radius: 5px;\r\n    }\r\n  }\r\n\r\n  .right {\r\n    width: 35%;\r\n    padding: 20px;\r\n    background: #fff;\r\n    border-radius: 4px;\r\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n  }\r\n}\r\n\r\n.city-list {\r\n  .city-item {\r\n    margin-bottom: 15px;\r\n\r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n\r\n    .city-info {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      margin-bottom: 5px;\r\n      font-size: 14px;\r\n\r\n      .city-name {\r\n        color: #606266;\r\n      }\r\n\r\n      .city-count {\r\n        color: #409eff;\r\n        font-weight: bold;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}