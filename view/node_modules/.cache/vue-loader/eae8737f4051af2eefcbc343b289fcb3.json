{"remainingRequest":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\desktop\\rent\\view\\src\\views\\user\\HouseNewsDetail.vue?vue&type=style&index=0&id=3954b60c&scoped=true&lang=scss&","dependencies":[{"path":"D:\\desktop\\rent\\view\\src\\views\\user\\HouseNewsDetail.vue","mtime":1771035192436},{"path":"D:\\desktop\\rent\\view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1765027960330},{"path":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1765027965207},{"path":"D:\\desktop\\rent\\view\\node_modules\\postcss-loader\\src\\index.js","mtime":1765027962540},{"path":"D:\\desktop\\rent\\view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1765027958888},{"path":"D:\\desktop\\rent\\view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1765027958923},{"path":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\index.js","mtime":1765027963512}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouY29udGFpbmVyLWhvdXNlLW5ld3Mgew0KICB3aWR0aDogMTAwJTsNCiAgbWluLWhlaWdodDogMTAwdmg7DQogIGJhY2tncm91bmQtY29sb3I6IHJnYigyNDQsIDI0NCwgMjQ0KTsNCg0KICAuY29udGFpbmVyLWRldGFpbCB7DQogICAgd2lkdGg6IDcwMHB4Ow0KICAgIG1pbi1oZWlnaHQ6IDEwMHZoOw0KICAgIG1hcmdpbjogMCBhdXRvOw0KICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCA4cHggcmdiKDIyMCwgMjIwLCAyMjApOw0KICAgIHBhZGRpbmc6IDIwcHggMzBweDsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KDQogICAgLnRpdGxlIHsNCiAgICAgIGZvbnQtc2l6ZTogMzJweDsNCiAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7DQogICAgfQ0KDQogICAgLmNyZWF0ZS10aW1lIHsNCiAgICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICAgIG1hcmdpbi1ibG9jazogMjBweDsNCiAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICBnYXA6IDEwcHg7DQogICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KDQogICAgICAuc2F2ZSB7DQogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyNDAsIDI0MCwgMjQwKTsNCiAgICAgICAgcGFkZGluZzogNHB4IDEwcHg7DQogICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KDQogICAgICAgICY6aG92ZXIgew0KICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyMzQsIDIzNCwgMjM0KTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIC5zdW1tYXJ5IHsNCiAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyNDQsIDI0NiwgMjQ4KTsNCiAgICAgIHBhZGRpbmc6IDEwcHg7DQogICAgICBmb250LXNpemU6IDE0cHg7DQogICAgICBsaW5lLWhlaWdodDogMS41Ow0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["HouseNewsDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyKA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"HouseNewsDetail.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n  <div class=\"container-house-news\">\r\n    <div class=\"container-detail\">\r\n      <div class=\"title\">\r\n        {{ houseNews.title }}\r\n      </div>\r\n\r\n      <div class=\"create-time\">\r\n        <div class=\"time\">发布于{{ houseNews.createTime }}</div>\r\n\r\n        <div class=\"save\" @click=\"collectHouseOperation\">\r\n          <i\r\n            :class=\"\r\n              saveList.length > 0 ? 'el-icon-star-on' : 'el-icon-star-off'\r\n            \"\r\n          ></i>\r\n\r\n          {{ saveList.length > 0 ? \"取消收藏\" : \"收藏\" }}\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"summary\">\r\n        {{ houseNews.summary }}\r\n      </div>\r\n\r\n      <div class=\"content\" v-html=\"houseNews.content\"></div>\r\n\r\n      <div class=\"evaluations\">\r\n        <Evaluations\r\n          :userId=\"Number(userId)\"\r\n          :avatar=\"String(avatar)\"\r\n          :contentId=\"Number(houseNewsId)\"\r\n          contentType=\"HOUSE_NEWS_INFO\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Evaluations from \"@/components/Evaluations\";\r\nexport default {\r\n  components: { Evaluations },\r\n  data() {\r\n    return {\r\n      houseNewsId: null,\r\n      houseNews: {},\r\n      userId: null,\r\n      avatar: \"\",\r\n      saveList: [],\r\n      startTime: 0,\r\n      hasRecorded: false // 防止重复记录\r\n    };\r\n  },\r\n  created() {\r\n    this.getPathId();\r\n    this.fetchUserInfo();\r\n  },\r\n  mounted() {\r\n    this.startTime = performance.now(); // 更精确的高精度时间\r\n    window.addEventListener(\"beforeunload\", this.handlePageLeave);\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener(\"beforeunload\", this.handlePageLeave);\r\n  },\r\n  methods: {\r\n    handlePageLeave() {\r\n      if (this.hasRecorded) return;\r\n\r\n      const endTime = performance.now();\r\n      const stayTime = Math.floor(endTime - this.startTime);\r\n\r\n      this.hasRecorded = true;\r\n\r\n      this.sendStayTime(stayTime);\r\n    },\r\n    async sendStayTime(duration) {\r\n      try {\r\n        await this.$axios.post(\"/flow-index/stayOperation\", {\r\n          contentId: this.houseNewsId,\r\n          times: duration,\r\n          contentType: \"HOUSE_NEWS\"\r\n        });\r\n      } catch (e) {\r\n        console.error(\"记录停留时间失败:\", e);\r\n      }\r\n    },\r\n    getPathId() {\r\n      this.houseNewsId = this.$route.query.id;\r\n      this.fetchHouseNewsInfo(this.houseNewsId);\r\n      this.recordViewOperation(this.houseNewsId);\r\n      this.recordSaveStatus(this.houseNewsId);\r\n    },\r\n    // 查询用户对于内容的收藏情况\r\n    async recordSaveStatus(id) {\r\n      try {\r\n        const flowIndexQueryDto = {\r\n          contentId: id,\r\n          contentType: \"HOUSE_NEWS\",\r\n          type: 2\r\n        };\r\n        const { data } = await this.$axios.post(\r\n          `/flow-index/listUser`,\r\n          flowIndexQueryDto\r\n        );\r\n        this.saveList = data;\r\n      } catch (error) {\r\n        console.info(error);\r\n      }\r\n    },\r\n    // 浏览操作\r\n    async recordViewOperation(id) {\r\n      try {\r\n        const flowIndex = {\r\n          contentId: id,\r\n          contentType: \"HOUSE_NEWS\"\r\n        };\r\n        await this.$axios.post(`/flow-index/viewOperation`, flowIndex);\r\n      } catch (error) {\r\n        console.info(error);\r\n      }\r\n    },\r\n    async fetchUserInfo() {\r\n      try {\r\n        const { data } = await this.$axios.get(`/user/auth`);\r\n        this.userId = data.id;\r\n        this.avatar = data.avatar;\r\n      } catch (error) {\r\n        this.$message.error(\"获取用户信息失败\");\r\n        console.error(error);\r\n      }\r\n    },\r\n    async fetchHouseNewsInfo(id) {\r\n      try {\r\n        const { data } = await this.$axios.get(`/house-news/getById/${id}`);\r\n        this.houseNews = { ...data };\r\n      } catch (error) {\r\n        this.$message.error(\"获取房屋资讯信息失败\");\r\n        console.error(error);\r\n      }\r\n    },\r\n    // 收藏操作\r\n    async collectHouseOperation() {\r\n      try {\r\n        const flowIndex = {\r\n          contentId: this.houseNewsId,\r\n          contentType: \"HOUSE_NEWS\"\r\n        };\r\n        const { message } = await this.$axios.post(\r\n          `/flow-index/saveOperation`,\r\n          flowIndex\r\n        );\r\n        this.$notify.success({\r\n          title: \"收藏操作\",\r\n          message: message,\r\n          position: \"buttom-right\",\r\n          duration: 1000\r\n        });\r\n        this.recordSaveStatus(this.houseNewsId);\r\n      } catch (error) {\r\n        this.$message.error(error);\r\n        console.info(error);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.container-house-news {\r\n  width: 100%;\r\n  min-height: 100vh;\r\n  background-color: rgb(244, 244, 244);\r\n\r\n  .container-detail {\r\n    width: 700px;\r\n    min-height: 100vh;\r\n    margin: 0 auto;\r\n    background-color: rgb(255, 255, 255);\r\n    box-shadow: 0 4px 8px rgb(220, 220, 220);\r\n    padding: 20px 30px;\r\n    box-sizing: border-box;\r\n\r\n    .title {\r\n      font-size: 32px;\r\n      font-weight: 800;\r\n    }\r\n\r\n    .create-time {\r\n      font-size: 14px;\r\n      margin-block: 20px;\r\n      display: flex;\r\n      gap: 10px;\r\n      align-items: center;\r\n\r\n      .save {\r\n        background-color: rgb(240, 240, 240);\r\n        padding: 4px 10px;\r\n        border-radius: 5px;\r\n        cursor: pointer;\r\n\r\n        &:hover {\r\n          background-color: rgb(234, 234, 234);\r\n        }\r\n      }\r\n    }\r\n\r\n    .summary {\r\n      background-color: rgb(244, 246, 248);\r\n      padding: 10px;\r\n      font-size: 14px;\r\n      line-height: 1.5;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}