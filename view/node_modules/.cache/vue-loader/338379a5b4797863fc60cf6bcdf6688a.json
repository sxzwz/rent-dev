{"remainingRequest":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\desktop\\rent\\view\\src\\views\\user\\HouseNewsDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\desktop\\rent\\view\\src\\views\\user\\HouseNewsDetail.vue","mtime":1771035192436},{"path":"D:\\desktop\\rent\\view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1765027958923},{"path":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\index.js","mtime":1765027963512}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRXZhbHVhdGlvbnMgZnJvbSAiQC9jb21wb25lbnRzL0V2YWx1YXRpb25zIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogeyBFdmFsdWF0aW9ucyB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBob3VzZU5ld3NJZDogbnVsbCwNCiAgICAgIGhvdXNlTmV3czoge30sDQogICAgICB1c2VySWQ6IG51bGwsDQogICAgICBhdmF0YXI6ICIiLA0KICAgICAgc2F2ZUxpc3Q6IFtdLA0KICAgICAgc3RhcnRUaW1lOiAwLA0KICAgICAgaGFzUmVjb3JkZWQ6IGZhbHNlIC8vIOmYsuatoumHjeWkjeiusOW9lQ0KICAgIH07DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5nZXRQYXRoSWQoKTsNCiAgICB0aGlzLmZldGNoVXNlckluZm8oKTsNCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLnN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpOyAvLyDmm7Tnsr7noa7nmoTpq5jnsr7luqbml7bpl7QNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigiYmVmb3JldW5sb2FkIiwgdGhpcy5oYW5kbGVQYWdlTGVhdmUpOw0KICB9LA0KICBiZWZvcmVEZXN0cm95KCkgew0KICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJiZWZvcmV1bmxvYWQiLCB0aGlzLmhhbmRsZVBhZ2VMZWF2ZSk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBoYW5kbGVQYWdlTGVhdmUoKSB7DQogICAgICBpZiAodGhpcy5oYXNSZWNvcmRlZCkgcmV0dXJuOw0KDQogICAgICBjb25zdCBlbmRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7DQogICAgICBjb25zdCBzdGF5VGltZSA9IE1hdGguZmxvb3IoZW5kVGltZSAtIHRoaXMuc3RhcnRUaW1lKTsNCg0KICAgICAgdGhpcy5oYXNSZWNvcmRlZCA9IHRydWU7DQoNCiAgICAgIHRoaXMuc2VuZFN0YXlUaW1lKHN0YXlUaW1lKTsNCiAgICB9LA0KICAgIGFzeW5jIHNlbmRTdGF5VGltZShkdXJhdGlvbikgew0KICAgICAgdHJ5IHsNCiAgICAgICAgYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgiL2Zsb3ctaW5kZXgvc3RheU9wZXJhdGlvbiIsIHsNCiAgICAgICAgICBjb250ZW50SWQ6IHRoaXMuaG91c2VOZXdzSWQsDQogICAgICAgICAgdGltZXM6IGR1cmF0aW9uLA0KICAgICAgICAgIGNvbnRlbnRUeXBlOiAiSE9VU0VfTkVXUyINCiAgICAgICAgfSk7DQogICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoIuiusOW9leWBnOeVmeaXtumXtOWksei0pToiLCBlKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGdldFBhdGhJZCgpIHsNCiAgICAgIHRoaXMuaG91c2VOZXdzSWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5pZDsNCiAgICAgIHRoaXMuZmV0Y2hIb3VzZU5ld3NJbmZvKHRoaXMuaG91c2VOZXdzSWQpOw0KICAgICAgdGhpcy5yZWNvcmRWaWV3T3BlcmF0aW9uKHRoaXMuaG91c2VOZXdzSWQpOw0KICAgICAgdGhpcy5yZWNvcmRTYXZlU3RhdHVzKHRoaXMuaG91c2VOZXdzSWQpOw0KICAgIH0sDQogICAgLy8g5p+l6K+i55So5oi35a+55LqO5YaF5a6555qE5pS26JeP5oOF5Ya1DQogICAgYXN5bmMgcmVjb3JkU2F2ZVN0YXR1cyhpZCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmxvd0luZGV4UXVlcnlEdG8gPSB7DQogICAgICAgICAgY29udGVudElkOiBpZCwNCiAgICAgICAgICBjb250ZW50VHlwZTogIkhPVVNFX05FV1MiLA0KICAgICAgICAgIHR5cGU6IDINCiAgICAgICAgfTsNCiAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCB0aGlzLiRheGlvcy5wb3N0KA0KICAgICAgICAgIGAvZmxvdy1pbmRleC9saXN0VXNlcmAsDQogICAgICAgICAgZmxvd0luZGV4UXVlcnlEdG8NCiAgICAgICAgKTsNCiAgICAgICAgdGhpcy5zYXZlTGlzdCA9IGRhdGE7DQogICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmluZm8oZXJyb3IpOw0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g5rWP6KeI5pON5L2cDQogICAgYXN5bmMgcmVjb3JkVmlld09wZXJhdGlvbihpZCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmxvd0luZGV4ID0gew0KICAgICAgICAgIGNvbnRlbnRJZDogaWQsDQogICAgICAgICAgY29udGVudFR5cGU6ICJIT1VTRV9ORVdTIg0KICAgICAgICB9Ow0KICAgICAgICBhd2FpdCB0aGlzLiRheGlvcy5wb3N0KGAvZmxvdy1pbmRleC92aWV3T3BlcmF0aW9uYCwgZmxvd0luZGV4KTsNCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuaW5mbyhlcnJvcik7DQogICAgICB9DQogICAgfSwNCiAgICBhc3luYyBmZXRjaFVzZXJJbmZvKCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCB0aGlzLiRheGlvcy5nZXQoYC91c2VyL2F1dGhgKTsNCiAgICAgICAgdGhpcy51c2VySWQgPSBkYXRhLmlkOw0KICAgICAgICB0aGlzLmF2YXRhciA9IGRhdGEuYXZhdGFyOw0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6I635Y+W55So5oi35L+h5oGv5aSx6LSlIik7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOw0KICAgICAgfQ0KICAgIH0sDQogICAgYXN5bmMgZmV0Y2hIb3VzZU5ld3NJbmZvKGlkKSB7DQogICAgICB0cnkgew0KICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHRoaXMuJGF4aW9zLmdldChgL2hvdXNlLW5ld3MvZ2V0QnlJZC8ke2lkfWApOw0KICAgICAgICB0aGlzLmhvdXNlTmV3cyA9IHsgLi4uZGF0YSB9Ow0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6I635Y+W5oi/5bGL6LWE6K6v5L+h5oGv5aSx6LSlIik7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOw0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g5pS26JeP5pON5L2cDQogICAgYXN5bmMgY29sbGVjdEhvdXNlT3BlcmF0aW9uKCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmxvd0luZGV4ID0gew0KICAgICAgICAgIGNvbnRlbnRJZDogdGhpcy5ob3VzZU5ld3NJZCwNCiAgICAgICAgICBjb250ZW50VHlwZTogIkhPVVNFX05FV1MiDQogICAgICAgIH07DQogICAgICAgIGNvbnN0IHsgbWVzc2FnZSB9ID0gYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgNCiAgICAgICAgICBgL2Zsb3ctaW5kZXgvc2F2ZU9wZXJhdGlvbmAsDQogICAgICAgICAgZmxvd0luZGV4DQogICAgICAgICk7DQogICAgICAgIHRoaXMuJG5vdGlmeS5zdWNjZXNzKHsNCiAgICAgICAgICB0aXRsZTogIuaUtuiXj+aTjeS9nCIsDQogICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSwNCiAgICAgICAgICBwb3NpdGlvbjogImJ1dHRvbS1yaWdodCIsDQogICAgICAgICAgZHVyYXRpb246IDEwMDANCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMucmVjb3JkU2F2ZVN0YXR1cyh0aGlzLmhvdXNlTmV3c0lkKTsNCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyb3IpOw0KICAgICAgICBjb25zb2xlLmluZm8oZXJyb3IpOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["HouseNewsDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"HouseNewsDetail.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n  <div class=\"container-house-news\">\r\n    <div class=\"container-detail\">\r\n      <div class=\"title\">\r\n        {{ houseNews.title }}\r\n      </div>\r\n\r\n      <div class=\"create-time\">\r\n        <div class=\"time\">发布于{{ houseNews.createTime }}</div>\r\n\r\n        <div class=\"save\" @click=\"collectHouseOperation\">\r\n          <i\r\n            :class=\"\r\n              saveList.length > 0 ? 'el-icon-star-on' : 'el-icon-star-off'\r\n            \"\r\n          ></i>\r\n\r\n          {{ saveList.length > 0 ? \"取消收藏\" : \"收藏\" }}\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"summary\">\r\n        {{ houseNews.summary }}\r\n      </div>\r\n\r\n      <div class=\"content\" v-html=\"houseNews.content\"></div>\r\n\r\n      <div class=\"evaluations\">\r\n        <Evaluations\r\n          :userId=\"Number(userId)\"\r\n          :avatar=\"String(avatar)\"\r\n          :contentId=\"Number(houseNewsId)\"\r\n          contentType=\"HOUSE_NEWS_INFO\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Evaluations from \"@/components/Evaluations\";\r\nexport default {\r\n  components: { Evaluations },\r\n  data() {\r\n    return {\r\n      houseNewsId: null,\r\n      houseNews: {},\r\n      userId: null,\r\n      avatar: \"\",\r\n      saveList: [],\r\n      startTime: 0,\r\n      hasRecorded: false // 防止重复记录\r\n    };\r\n  },\r\n  created() {\r\n    this.getPathId();\r\n    this.fetchUserInfo();\r\n  },\r\n  mounted() {\r\n    this.startTime = performance.now(); // 更精确的高精度时间\r\n    window.addEventListener(\"beforeunload\", this.handlePageLeave);\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener(\"beforeunload\", this.handlePageLeave);\r\n  },\r\n  methods: {\r\n    handlePageLeave() {\r\n      if (this.hasRecorded) return;\r\n\r\n      const endTime = performance.now();\r\n      const stayTime = Math.floor(endTime - this.startTime);\r\n\r\n      this.hasRecorded = true;\r\n\r\n      this.sendStayTime(stayTime);\r\n    },\r\n    async sendStayTime(duration) {\r\n      try {\r\n        await this.$axios.post(\"/flow-index/stayOperation\", {\r\n          contentId: this.houseNewsId,\r\n          times: duration,\r\n          contentType: \"HOUSE_NEWS\"\r\n        });\r\n      } catch (e) {\r\n        console.error(\"记录停留时间失败:\", e);\r\n      }\r\n    },\r\n    getPathId() {\r\n      this.houseNewsId = this.$route.query.id;\r\n      this.fetchHouseNewsInfo(this.houseNewsId);\r\n      this.recordViewOperation(this.houseNewsId);\r\n      this.recordSaveStatus(this.houseNewsId);\r\n    },\r\n    // 查询用户对于内容的收藏情况\r\n    async recordSaveStatus(id) {\r\n      try {\r\n        const flowIndexQueryDto = {\r\n          contentId: id,\r\n          contentType: \"HOUSE_NEWS\",\r\n          type: 2\r\n        };\r\n        const { data } = await this.$axios.post(\r\n          `/flow-index/listUser`,\r\n          flowIndexQueryDto\r\n        );\r\n        this.saveList = data;\r\n      } catch (error) {\r\n        console.info(error);\r\n      }\r\n    },\r\n    // 浏览操作\r\n    async recordViewOperation(id) {\r\n      try {\r\n        const flowIndex = {\r\n          contentId: id,\r\n          contentType: \"HOUSE_NEWS\"\r\n        };\r\n        await this.$axios.post(`/flow-index/viewOperation`, flowIndex);\r\n      } catch (error) {\r\n        console.info(error);\r\n      }\r\n    },\r\n    async fetchUserInfo() {\r\n      try {\r\n        const { data } = await this.$axios.get(`/user/auth`);\r\n        this.userId = data.id;\r\n        this.avatar = data.avatar;\r\n      } catch (error) {\r\n        this.$message.error(\"获取用户信息失败\");\r\n        console.error(error);\r\n      }\r\n    },\r\n    async fetchHouseNewsInfo(id) {\r\n      try {\r\n        const { data } = await this.$axios.get(`/house-news/getById/${id}`);\r\n        this.houseNews = { ...data };\r\n      } catch (error) {\r\n        this.$message.error(\"获取房屋资讯信息失败\");\r\n        console.error(error);\r\n      }\r\n    },\r\n    // 收藏操作\r\n    async collectHouseOperation() {\r\n      try {\r\n        const flowIndex = {\r\n          contentId: this.houseNewsId,\r\n          contentType: \"HOUSE_NEWS\"\r\n        };\r\n        const { message } = await this.$axios.post(\r\n          `/flow-index/saveOperation`,\r\n          flowIndex\r\n        );\r\n        this.$notify.success({\r\n          title: \"收藏操作\",\r\n          message: message,\r\n          position: \"buttom-right\",\r\n          duration: 1000\r\n        });\r\n        this.recordSaveStatus(this.houseNewsId);\r\n      } catch (error) {\r\n        this.$message.error(error);\r\n        console.info(error);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.container-house-news {\r\n  width: 100%;\r\n  min-height: 100vh;\r\n  background-color: rgb(244, 244, 244);\r\n\r\n  .container-detail {\r\n    width: 700px;\r\n    min-height: 100vh;\r\n    margin: 0 auto;\r\n    background-color: rgb(255, 255, 255);\r\n    box-shadow: 0 4px 8px rgb(220, 220, 220);\r\n    padding: 20px 30px;\r\n    box-sizing: border-box;\r\n\r\n    .title {\r\n      font-size: 32px;\r\n      font-weight: 800;\r\n    }\r\n\r\n    .create-time {\r\n      font-size: 14px;\r\n      margin-block: 20px;\r\n      display: flex;\r\n      gap: 10px;\r\n      align-items: center;\r\n\r\n      .save {\r\n        background-color: rgb(240, 240, 240);\r\n        padding: 4px 10px;\r\n        border-radius: 5px;\r\n        cursor: pointer;\r\n\r\n        &:hover {\r\n          background-color: rgb(234, 234, 234);\r\n        }\r\n      }\r\n    }\r\n\r\n    .summary {\r\n      background-color: rgb(244, 246, 248);\r\n      padding: 10px;\r\n      font-size: 14px;\r\n      line-height: 1.5;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}