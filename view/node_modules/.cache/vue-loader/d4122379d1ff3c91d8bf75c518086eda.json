{"remainingRequest":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\desktop\\rent\\view\\src\\views\\admin\\Main.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\desktop\\rent\\view\\src\\views\\admin\\Main.vue","mtime":1771039440729},{"path":"D:\\desktop\\rent\\view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1765027958923},{"path":"D:\\desktop\\rent\\view\\node_modules\\vue-loader\\lib\\index.js","mtime":1765027963512}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgTGluZUNoYXJ0IGZyb20gIkAvY29tcG9uZW50cy9MaW5lQ2hhcnQiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7IExpbmVDaGFydCB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBzdGF0aWNWYWx1ZXM6IFtdLA0KICAgICAgdmFsdWVzOiBbXSwgLy8geei9tA0KICAgICAgZGF0ZUxpc3Q6IFtdLCAvLyB46L20DQogICAgICBjaXR5SG91c2VMaXN0OiBbXSwgLy8g5Z+O5biC5b6F56ef5oi/5rqQ5YiG5biDDQogICAgICBkZWZhdWx0U2VsZWN0RGF5czogMzY1LCAvL+m7mOiupOafpeS4gOW5tA0KICAgICAgZGVmYXVsdFNlbGVjdENpdHk6IDEwLCAvLyDpu5jorqTmn6Xor6Lln47luILmlbANCiAgICAgIHNlbGVjdGVkU29ydDogImNvdW50LWRlc2MiLCAvLyDmt7vliqDmjpLluo/mlrnlvI8NCiAgICAgIGNvbG9yUGFsZXR0ZTogWw0KICAgICAgICAvLyDmt7vliqDpopzoibLphY3nva4NCiAgICAgICAgIiM0MDlFRkYiLA0KICAgICAgICAiIzY3QzIzQSIsDQogICAgICAgICIjRTZBMjNDIiwNCiAgICAgICAgIiNGNTZDNkMiLA0KICAgICAgICAiIzkwOTM5OSIsDQogICAgICAgICIjOEU0NEFEIiwNCiAgICAgICAgIiMxQUJDOUMiLA0KICAgICAgICAiI0QzNTQwMCIsDQogICAgICAgICIjMzQ5OERCIiwNCiAgICAgICAgIiNFNzRDM0MiDQogICAgICBdDQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmZldGNoU3RhdGljVmFsdWVzKCk7DQogICAgdGhpcy5mZXRjaEhvdXNlTGluZUNoYXJ0KHRoaXMuZGVmYXVsdFNlbGVjdERheXMpOw0KICAgIHRoaXMuZmV0Y2hDaXR5SG91c2VSYW5nZSh0aGlzLmRlZmF1bHRTZWxlY3RDaXR5KTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBzb3J0ZWRDaXR5SG91c2VMaXN0KCkgew0KICAgICAgY29uc3QgbGlzdCA9IFsuLi50aGlzLmNpdHlIb3VzZUxpc3RdOw0KICAgICAgc3dpdGNoICh0aGlzLnNlbGVjdGVkU29ydCkgew0KICAgICAgICBjYXNlICJjb3VudC1kZXNjIjoNCiAgICAgICAgICByZXR1cm4gbGlzdC5zb3J0KChhLCBiKSA9PiBiLmNvdW50IC0gYS5jb3VudCk7DQogICAgICAgIGNhc2UgImNvdW50LWFzYyI6DQogICAgICAgICAgcmV0dXJuIGxpc3Quc29ydCgoYSwgYikgPT4gYS5jb3VudCAtIGIuY291bnQpOw0KICAgICAgICBjYXNlICJuYW1lLWFzYyI6DQogICAgICAgICAgcmV0dXJuIGxpc3Quc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7DQogICAgICAgIGNhc2UgIm5hbWUtZGVzYyI6DQogICAgICAgICAgcmV0dXJuIGxpc3Quc29ydCgoYSwgYikgPT4gYi5uYW1lLmxvY2FsZUNvbXBhcmUoYS5uYW1lKSk7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgcmV0dXJuIGxpc3Q7DQogICAgICB9DQogICAgfSwNCiAgICBtYXhDb3VudCgpIHsNCiAgICAgIGlmICh0aGlzLmNpdHlIb3VzZUxpc3QubGVuZ3RoID09PSAwKSByZXR1cm4gMTsNCiAgICAgIHJldHVybiBNYXRoLm1heCguLi50aGlzLmNpdHlIb3VzZUxpc3QubWFwKGNpdHkgPT4gY2l0eS5jb3VudCkpOw0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGdldFByb2dyZXNzQ29sb3IoaW5kZXgpIHsNCiAgICAgIHJldHVybiB0aGlzLmNvbG9yUGFsZXR0ZVtpbmRleCAlIHRoaXMuY29sb3JQYWxldHRlLmxlbmd0aF07DQogICAgfSwNCiAgICBjYWxjdWxhdGVQZXJjZW50YWdlKGNvdW50KSB7DQogICAgICByZXR1cm4gKGNvdW50IC8gdGhpcy5tYXhDb3VudCkgKiAxMDA7DQogICAgfSwNCiAgICAvLyDoh6rlrprkuYnmj5DnpLrmoYbmoLzlvI8NCiAgICBjdXN0b21Ub29sdGlwRm9ybWF0dGVyKHBhcmFtcykgew0KICAgICAgLy8gcGFyYW1z5piv5LiA5Liq5pWw57uE77yM5YyF5ZCr5b2T5YmN54K555qE5omA5pyJ5L+h5oGvDQogICAgICBjb25zdCBkYXRlID0gcGFyYW1zWzBdLmF4aXNWYWx1ZTsgLy8g6I635Y+W5pel5pyfDQogICAgICBjb25zdCB2YWx1ZSA9IHBhcmFtc1swXS5kYXRhOyAvLyDojrflj5bmlbDlgLwNCiAgICAgIHJldHVybiBgJHtkYXRlfeWPt++8jOWFseS4iue6vyR7dmFsdWV95aWX5oi/5rqQYDsNCiAgICB9LA0KICAgIG9uU2VsZWN0ZWQoZGF5KSB7DQogICAgICB0aGlzLmZldGNoSG91c2VMaW5lQ2hhcnQoZGF5KTsNCiAgICB9LA0KICAgIGFzeW5jIGZldGNoQ2l0eUhvdXNlUmFuZ2UobGltaXQpIHsNCiAgICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgdGhpcy4kYXhpb3MuZ2V0KA0KICAgICAgICAgIGAvZGFzaGJvYXJkL2NpdHlIb3VzZVJhbmdlLyR7bGltaXR9YA0KICAgICAgICApOw0KICAgICAgICB0aGlzLmNpdHlIb3VzZUxpc3QgPSBkYXRhOw0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcigi5Z+O5biC5b6F56ef5oi/5rqQ5YiG5biDOiIsIGVycm9yKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGFzeW5jIGZldGNoSG91c2VMaW5lQ2hhcnQoZGF5KSB7DQogICAgICB0cnkgew0KICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHRoaXMuJGF4aW9zLmdldCgNCiAgICAgICAgICBgL2Rhc2hib2FyZC9ob3VzZUxpbmVDaGFydC8ke2RheX1gDQogICAgICAgICk7DQogICAgICAgIHRoaXMuZGF0ZUxpc3QgPSBkYXRhLm1hcChlbnRpdHkgPT4gZW50aXR5Lm5hbWUpOyAvLyDlpITnkIbmiJB46L205pWw5o2u5qC85byPDQogICAgICAgIHRoaXMudmFsdWVzID0gZGF0YS5tYXAoZW50aXR5ID0+IGVudGl0eS5jb3VudCk7IC8vIOWkhOeQhuaIkHnovbTmlbDmja7moLzlvI8NCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoIuaIv+a6kOWtmOmHj+i2i+WKv+e7n+iuoeW8guW4uDoiLCBlcnJvcik7DQogICAgICB9DQogICAgfSwNCiAgICBhc3luYyBmZXRjaFN0YXRpY1ZhbHVlcygpIHsNCiAgICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgdGhpcy4kYXhpb3MuZ2V0KCIvZGFzaGJvYXJkL21haW5TdGF0aWMiKTsNCiAgICAgICAgdGhpcy5zdGF0aWNWYWx1ZXMgPSBkYXRhOw0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcigi6Z2Z5oCB5pWw5o2u57uf6K6h5byC5bi4OiIsIGVycm9yKTsNCiAgICAgIH0NCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["Main.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Main.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\r\n  <div class=\"main-container\">\r\n    <div class=\"left\">\r\n      <div class=\"static-value\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"6\" v-for=\"(item, index) in staticValues\" :key=\"index\">\r\n            <div>\r\n              <el-statistic\r\n                group-separator=\",\"\r\n                :precision=\"0\"\r\n                :value=\"item.count\"\r\n                :title=\"item.name\"\r\n              ></el-statistic>\r\n            </div>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n\r\n      <div style=\"margin-top: 30px;\">\r\n        <LineChart\r\n          :tooltipFormatter=\"customTooltipFormatter\"\r\n          height=\"450px\"\r\n          tag=\"房源存量趋势\"\r\n          :values=\"values\"\r\n          :date=\"dateList\"\r\n          @on-selected=\"onSelected\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"right\">\r\n      <h2 style=\"margin-top: 0;\">城市待租房源分布</h2>\r\n\r\n      <div class=\"city-list\">\r\n        <div\r\n          v-for=\"(city, index) in cityHouseList\"\r\n          :key=\"index\"\r\n          class=\"city-item\"\r\n        >\r\n          <div class=\"city-info\">\r\n            <span class=\"city-name\">{{ city.name }}</span>\r\n\r\n            <span class=\"city-count\">{{ city.count }}套</span>\r\n          </div>\r\n\r\n          <el-progress\r\n            :percentage=\"calculatePercentage(city.count)\"\r\n            :show-text=\"false\"\r\n            :stroke-width=\"12\"\r\n            :color=\"getProgressColor(index)\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport LineChart from \"@/components/LineChart\";\r\nexport default {\r\n  components: { LineChart },\r\n  data() {\r\n    return {\r\n      staticValues: [],\r\n      values: [], // y轴\r\n      dateList: [], // x轴\r\n      cityHouseList: [], // 城市待租房源分布\r\n      defaultSelectDays: 365, //默认查一年\r\n      defaultSelectCity: 10, // 默认查询城市数\r\n      selectedSort: \"count-desc\", // 添加排序方式\r\n      colorPalette: [\r\n        // 添加颜色配置\r\n        \"#409EFF\",\r\n        \"#67C23A\",\r\n        \"#E6A23C\",\r\n        \"#F56C6C\",\r\n        \"#909399\",\r\n        \"#8E44AD\",\r\n        \"#1ABC9C\",\r\n        \"#D35400\",\r\n        \"#3498DB\",\r\n        \"#E74C3C\"\r\n      ]\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchStaticValues();\r\n    this.fetchHouseLineChart(this.defaultSelectDays);\r\n    this.fetchCityHouseRange(this.defaultSelectCity);\r\n  },\r\n  computed: {\r\n    sortedCityHouseList() {\r\n      const list = [...this.cityHouseList];\r\n      switch (this.selectedSort) {\r\n        case \"count-desc\":\r\n          return list.sort((a, b) => b.count - a.count);\r\n        case \"count-asc\":\r\n          return list.sort((a, b) => a.count - b.count);\r\n        case \"name-asc\":\r\n          return list.sort((a, b) => a.name.localeCompare(b.name));\r\n        case \"name-desc\":\r\n          return list.sort((a, b) => b.name.localeCompare(a.name));\r\n        default:\r\n          return list;\r\n      }\r\n    },\r\n    maxCount() {\r\n      if (this.cityHouseList.length === 0) return 1;\r\n      return Math.max(...this.cityHouseList.map(city => city.count));\r\n    }\r\n  },\r\n  methods: {\r\n    getProgressColor(index) {\r\n      return this.colorPalette[index % this.colorPalette.length];\r\n    },\r\n    calculatePercentage(count) {\r\n      return (count / this.maxCount) * 100;\r\n    },\r\n    // 自定义提示框格式\r\n    customTooltipFormatter(params) {\r\n      // params是一个数组，包含当前点的所有信息\r\n      const date = params[0].axisValue; // 获取日期\r\n      const value = params[0].data; // 获取数值\r\n      return `${date}号，共上线${value}套房源`;\r\n    },\r\n    onSelected(day) {\r\n      this.fetchHouseLineChart(day);\r\n    },\r\n    async fetchCityHouseRange(limit) {\r\n      try {\r\n        const { data } = await this.$axios.get(\r\n          `/dashboard/cityHouseRange/${limit}`\r\n        );\r\n        this.cityHouseList = data;\r\n      } catch (error) {\r\n        console.error(\"城市待租房源分布:\", error);\r\n      }\r\n    },\r\n    async fetchHouseLineChart(day) {\r\n      try {\r\n        const { data } = await this.$axios.get(\r\n          `/dashboard/houseLineChart/${day}`\r\n        );\r\n        this.dateList = data.map(entity => entity.name); // 处理成x轴数据格式\r\n        this.values = data.map(entity => entity.count); // 处理成y轴数据格式\r\n      } catch (error) {\r\n        console.error(\"房源存量趋势统计异常:\", error);\r\n      }\r\n    },\r\n    async fetchStaticValues() {\r\n      try {\r\n        const { data } = await this.$axios.get(\"/dashboard/mainStatic\");\r\n        this.staticValues = data;\r\n      } catch (error) {\r\n        console.error(\"静态数据统计异常:\", error);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.main-container {\r\n  display: flex;\r\n  width: 100%;\r\n\r\n  .left {\r\n    width: 65%;\r\n    padding-inline: 30px;\r\n    box-sizing: border-box;\r\n\r\n    .static-value {\r\n      background-color: rgb(248, 248, 248);\r\n      padding: 20px;\r\n      box-sizing: border-box;\r\n      border-radius: 5px;\r\n    }\r\n  }\r\n\r\n  .right {\r\n    width: 35%;\r\n    padding: 20px;\r\n    background: #fff;\r\n    border-radius: 4px;\r\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n  }\r\n}\r\n\r\n.city-list {\r\n  .city-item {\r\n    margin-bottom: 15px;\r\n\r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n\r\n    .city-info {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      margin-bottom: 5px;\r\n      font-size: 14px;\r\n\r\n      .city-name {\r\n        color: #606266;\r\n      }\r\n\r\n      .city-count {\r\n        color: #409eff;\r\n        font-weight: bold;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}